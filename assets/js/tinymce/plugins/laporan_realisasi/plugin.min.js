tinymce.PluginManager.add('laporan_realisasi', function( editor, url ) {
	editor.addButton( 'laporan_realisasi', {
		text: 'Lap Realisasi',
		icon: false,
		onclick: function() {
      if(location.hostname === "localhost" || location.hostname === "127.0.0.1")
      {
        var _location = document.location.toString();
        var applicationNameIndex = _location.indexOf('/', _location.indexOf('://') + 3);
        var applicationName = _location.substring(0, applicationNameIndex) + '/';
        var webFolderIndex = _location.indexOf('/', _location.indexOf(applicationName) + applicationName.length);
        var webFolderFullPath = _location.substring(0, webFolderIndex);
        var url = webFolderFullPath + "/index.php/web/cek_tahun";
      }else{
        var url = location.protocol + "//" + location.hostname + "/index.php/web/cek_tahun";
      }

      $.ajax({
        type: "GET",
        url: url,
        dataType: "json",
        processData: true,
        success: function (data) {
          editor.windowManager.open( {
            title: 'Select Data Laporan Realisasi',
            body: [
              {
                type   : 'listbox',
                name   : 'semester',
                label  : 'Semester',
                values : [
                  { text: 'Semester 1', value: '1' },
                  { text: 'Semester 2', value: '2' }
                ],
                value : '1' 
              },
              {
                type   : 'listbox',
                name   : 'tahun',
                label  : 'Tahun',
                values : data,
              },
            ],
            onsubmit: function( e ) {
              editor.insertContent('[[lap-RP-APBD,' + e.data.semester +','+ e.data.tahun +']]');
            },
            width: 400,
            height: 140
          } )
        },
        error: function (xhr, status, error) {
            alert("Error! " + xhr.status + "\n" + error);
            console.log(xhr);
        }
      });			
		}
	});
});